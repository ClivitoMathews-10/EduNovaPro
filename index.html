 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EduNovaPro</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet" />

  <style>
    body {
      background-color: #00008B;
      margin: 0;
      min-height: 100vh;
      font-family: Arial, sans-serif;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
    }

    h1 {
      text-align: center;
      font-size: 2.5em;
      font-family: 'Orbitron', sans-serif;
      color: #99ccff;
      margin-top: 30px;
    }

    .login-area {
      width: 100%;
      max-width: 350px;
      text-align: center;
      margin-top: 20px;
    }

    .login-area input[type="text"] {
      width: 100%;
      margin: 10px 0;
      padding: 12px;
      font-size: 1em;
      border-radius: 6px;
      border: none;
      outline: none;
      box-sizing: border-box;
    }

    .login-area button {
      width: 100%;
      padding: 12px;
      font-size: 1em;
      border: none;
      border-radius: 6px;
      background-color: #3399FF;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 15px;
    }

    .login-area button:hover {
      background-color: #1e7ec8;
    }

    .shape {
      position: absolute;
      width: 100px;
      opacity: 2;
      z-index: 1;
    }

    .shape-top-left {
      top: 10px;
      left: 10px;
    }

    .shape-top-right {
      top: 10px;
      right: 10px;
    }

    @media (max-width: 500px) {
      .shape {
        display: none;
      }

      h1 {
        font-size: 2em;
      }
    }

    footer {
      margin-top: auto;
      text-align: center;
      color: white;
      font-size: 0.9em;
      padding-bottom: 20px;
    }

    footer a {
      color: #ffcc00;
      text-decoration: underline;
    }
  </style>
</head>

<body>
  <h1>EduNovaPro</h1>

  <div class="login-area">
    <input type="text" id="nameInput" placeholder="Enter your name">
    <input type="text" id="surnameInput" placeholder="Enter your surname">
    <input type="text" id="houseInput" placeholder="Enter your house">
    <input type="text" id="gradeInput" placeholder="Enter your grade">
    <button id="submitBtn" type="submit">Submit</button>
  </div>

  <img src="shape1.png" alt="Shape Top Left" class="shape shape-top-left">
  <img src="shape2.png" alt="Shape Top Right" class="shape shape-top-right">

  <footer>
    Â© 2025 Clivito Mathews. All rights reserved. |
    <a href="Source Document.docx" target="_blank">Source Document</a> |
    <a href="mailto:boyt24247@gmail.com?subject=Help with EduNovaPro">Any Problems? Click here!</a>
  </footer>

  <script>
    const submitBtn = document.getElementById("submitBtn");
    submitBtn.addEventListener("click", function() {
      const name = document.getElementById("nameInput").value.trim();
      const surname = document.getElementById("surnameInput").value.trim();
      const house = document.getElementById("houseInput").value.trim();
      const grade = document.getElementById("gradeInput").value.trim();

      if (!name || !surname || !house || !grade) {
        alert("Please fill in all fields.");
        return;
      }

      const userInfo = { name, surname, house, grade };
      localStorage.setItem("userInfo", JSON.stringify(userInfo));

      // Set session start time when user submits (overwrite any previous)
      localStorage.setItem("sessionStart", Date.now().toString());

      const data = new URLSearchParams();
      data.append("name", name);
      data.append("surname", surname);
      data.append("house", house);
      data.append("grade", grade);

      navigator.sendBeacon(
        "https://script.google.com/macros/s/AKfycbzEcAOLZAYHZ_69sZum7kKpv0Q_OJqMTXR_9j3NmKvWMs325vuOoW1qDNbFvFHwL1vS/exec",
        data
      );

      alert("Welcome, " + name + "!");

      if (grade === "8" || grade.toLowerCase() === "grade 8") {
        window.location.href = "dashboard8.html";
      }
    });

    // --- Heartbeat Session Tracking ---

    // Ensure sessionStart exists, if not, create it now
    if (!localStorage.getItem("sessionStart")) {
      localStorage.setItem("sessionStart", Date.now().toString());
    }

    // Function to calculate session duration in seconds
    function getSessionDuration() {
      const start = parseInt(localStorage.getItem("sessionStart"));
      const now = Date.now();
      return Math.round((now - start) / 1000);
    }

    // Function to send session duration to Google Sheets script
    function sendSessionTime() {
      const userInfoStr = localStorage.getItem("userInfo");
      if (!userInfoStr) return;

      const userInfo = JSON.parse(userInfoStr);
      const duration = getSessionDuration();

      const data = new URLSearchParams();
      data.append("name", userInfo.name);
      data.append("surname", userInfo.surname);
      data.append("house", userInfo.house);
      data.append("grade", userInfo.grade);
      data.append("duration", duration);

      if (navigator.sendBeacon) {
        navigator.sendBeacon(
          "https://script.google.com/macros/s/AKfycbxa4cA3wnQpgDSQl9bbz_rON8xp_0vSN1Mpqgyd-zQv7ju02U8_i50gYY1eOrgoC8WefA/exec",
          data
        );
      } else {
        fetch("https://script.google.com/macros/s/AKfycbxa4cA3wnQpgDSQl9bbz_rON8xp_0vSN1Mpqgyd-zQv7ju02U8_i50gYY1eOrgoC8WefA/exec", {
          method: "POST",
          body: data,
          keepalive: true,
        });
      }
    }

    // Send session time every 60 seconds
    setInterval(sendSessionTime, 60000);

    // Send session time on page unload (if possible)
    window.addEventListener("beforeunload", sendSessionTime);
  </script>
</body>
</html>
